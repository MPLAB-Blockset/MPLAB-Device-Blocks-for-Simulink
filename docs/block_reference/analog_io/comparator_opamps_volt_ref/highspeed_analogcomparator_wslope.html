<!DOCTYPE html>
<html lang="en">
<head>
    <title>MCHP High-Speed Analog Comparator with Slope Compensation Documentation - MPLAB Blockset for MATLAB/Simulink</title>
    <meta charset="utf-8">
    <style>
         
         

         
        :root {
             
            --bg-primary: #f8f9fa;
            --bg-secondary: white;
            --bg-tertiary: #f8f9fa;
            --text-primary: #2c3e50;
            --text-secondary: #666;
            --text-tertiary: #6c757d;
            --text-heading: #003d5c;
            --border-color: #dee2e6;
            --border-light: #e1e8ed;
            --border-medium: #e9ecef;
            --accent-primary: #0076A8;
            --accent-secondary: #005a85;
            --accent-hover: #005580;
            --accent-light: #e3f2fd;
            --code-bg: #f4f4f4;
            --code-text: #c7254e;
            --pre-bg: linear-gradient(to bottom, #e8e8e8 0%, #f0f0f0 100%);
            --pre-border: #d0d0d0;
            --table-hover: #e3f2fd;
            --table-stripe: #f8f9fa;
            --note-bg: linear-gradient(to right, #e7f3fe 0%, #f5fbff 100%);
            --note-border: #2196F3;
            --note-text: #1976D2;
            --warning-bg: linear-gradient(to right, #fff9e6 0%, #fffcf0 100%);
            --warning-border: #ff9800;
            --warning-text: #f57c00;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.05);
            --shadow-md: 0 2px 8px rgba(0,0,0,0.08);
            --shadow-lg: 0 2px 12px rgba(0,0,0,0.08);
        }

        [data-theme="dark"] {
             
            --bg-primary: #1a1d23;
            --bg-secondary: #242831;
            --bg-tertiary: #2d3139;
            --text-primary: #e4e6eb;
            --text-secondary: #adb5bd;
            --text-tertiary: #8b95a1;
            --text-heading: #e4e6eb;
            --border-color: #3a3f4b;
            --border-light: #3a3f4b;
            --border-medium: #404654;
            --accent-primary: #4da6d6;
            --accent-secondary: #3d8ab5;
            --accent-hover: #60b4e0;
            --accent-light: #2d4556;
            --code-bg: #2d3139;
            --code-text: #ff6b9d;
            --pre-bg: linear-gradient(to bottom, #2d3139 0%, #2d3139 100%);
            --pre-border: #3a3f4b;
            --table-hover: #2d4556;
            --table-stripe: #2d3139;
            --note-bg: linear-gradient(to right, #1e3a52 0%, #1e3a52 100%);
            --note-border: #4da6d6;
            --note-text: #66b3e0;
            --warning-bg: linear-gradient(to right, #3d3520 0%, #3d3520 100%);
            --warning-border: #ffb347;
            --warning-text: #ffc870;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.3);
            --shadow-md: 0 2px 8px rgba(0,0,0,0.4);
            --shadow-lg: 0 2px 12px rgba(0,0,0,0.5);
        }

         
        
        :root {
             
            --content-max-width: 1000px;
            --content-margin-horizontal: 30px;
            --content-margin-vertical: 15px;
            --container-border-radius: 8px;
        }
        

         
        * {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            margin: 0;
            padding: 0;
            line-height: 1.6;
            color: var(--text-primary);
            background-color: var(--bg-primary);
            font-size: 15px;
        }

         
        
         
        .doc-wrapper {
            display: flex;
            max-width: 1600px;
            margin: 0 auto;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background-color: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
            overflow-x: hidden;
            flex-shrink: 0;
        }

        .sidebar::-webkit-scrollbar {
            width: 8px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: var(--accent-primary);
        }

        .content-wrapper {
            flex: 1;
            min-width: 0;
            background-color: var(--bg-primary);
        }

        .container {
            max-width: var(--content-max-width);
            margin: var(--content-margin-vertical) var(--content-margin-horizontal);
            background-color: var(--bg-secondary);
            padding: 30px;
            box-shadow: var(--shadow-lg);
            border-radius: var(--container-border-radius);
        }
        

         
        
        .sidebar-header {
            padding: 20px;
            border-bottom: 2px solid var(--border-light);
            background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-secondary) 100%);
        }

        .sidebar-title {
            color: white;
            font-size: 16px;
            font-weight: 700;
            margin: 0;
            text-align: center;
        }

        .sidebar-nav {
            padding: 15px 0;
        }

        .nav-section {
            margin-bottom: 8px;
        }

        .nav-section-title {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 20px;
            color: var(--text-primary);
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
        }

        .nav-section-title:hover {
            background-color: var(--bg-tertiary);
            border-left-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        .nav-section-title .icon {
            font-size: 16px;
            margin-right: 8px;
        }

        .nav-section-title .toggle-icon {
            font-size: 12px;
            transition: transform 0.2s ease;
        }

        .nav-section.expanded .toggle-icon {
            transform: rotate(90deg);
        }

        .nav-section-children {
            display: none;
            padding-left: 15px;
        }

        .nav-section.expanded > .nav-section-children {
            display: block;
        }

        .nav-link {
            display: block;
            padding: 8px 20px;
            padding-left: 45px;
            color: var(--text-secondary);
            font-size: 13px;
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
        }

        .nav-link:hover {
            background-color: var(--bg-tertiary);
            color: var(--accent-primary);
            border-left-color: var(--accent-light);
        }

        .nav-link.active {
            background-color: var(--accent-light);
            color: var(--accent-primary);
            border-left-color: var(--accent-primary);
            font-weight: 600;
        }

         
        .nav-subsection {
            margin-bottom: 4px;
        }

        .nav-subsection-title {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 20px;
            padding-left: 35px;
            color: var(--text-primary);
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            background-color: var(--bg-tertiary);
        }

        .nav-subsection-title:hover {
            background-color: var(--bg-primary);
            border-left-color: var(--accent-secondary);
            color: var(--accent-secondary);
        }

        .nav-subsection-title .icon {
            font-size: 14px;
            margin-right: 6px;
        }

        .nav-subsection-title .toggle-icon {
            font-size: 10px;
            transition: transform 0.2s ease;
        }

        .nav-subsection.expanded .toggle-icon {
            transform: rotate(90deg);
        }

        .nav-subsection .nav-section-children {
            display: none;
            padding-left: 10px;
        }

        .nav-subsection.expanded > .nav-section-children {
            display: block;
        }

         
        .nav-block-link {
            display: block;
            padding: 6px 20px;
            padding-left: 55px;
            color: var(--text-secondary);
            font-size: 12px;
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
        }

        .nav-block-link:hover {
            background-color: var(--accent-light);
            color: var(--accent-primary);
            border-left-color: var(--accent-secondary);
        }

        .nav-block-link.active {
            background-color: var(--accent-light);
            color: var(--accent-primary);
            border-left-color: var(--accent-primary);
            font-weight: 600;
        }

        .mobile-nav-toggle {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--accent-primary);
            color: white;
            border: none;
            font-size: 24px;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
        }

        .mobile-nav-toggle:hover {
            background: var(--accent-hover);
        }
        

         
        .theme-toggle {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 6px 12px;
            font-size: 13px;
            color: var(--text-secondary);
            margin-left: 16px;
            user-select: none;
        }

        .theme-toggle:hover {
            background: var(--accent-light);
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        .theme-icon {
            font-size: 16px;
        }

         
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0 12px 0;
            margin-bottom: 20px;
            border-bottom: 3px solid var(--border-light);
            position: relative;
        }

        .page-header::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 120px;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
        }

        .page-header h1 {
            margin: 0;
            color: var(--text-heading);
            font-size: 32px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .page-header-right {
            display: flex;
            align-items: center;
        }

        .microchip-logo {
            height: 55px;
        }

         
        .breadcrumbs {
            display: flex;
            align-items: center;
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 16px;
            padding: 10px 14px;
            background: var(--bg-tertiary);
            border-radius: 6px;
            border-left: 3px solid var(--accent-primary);
        }

        .breadcrumbs a {
            color: var(--accent-primary);
            text-decoration: none;
            padding: 4px 8px;
            border-radius: 3px;
        }

        .breadcrumbs a:hover {
            background-color: var(--accent-light);
            color: var(--accent-hover);
        }

        .breadcrumbs span {
            margin: 0 8px;
            color: var(--text-tertiary);
        }

         
        h2 {
            color: var(--text-heading);
            font-weight: 600;
            font-size: 22px;
            letter-spacing: -0.5px;
            margin-top: 32px;
            margin-bottom: 12px;
            padding-bottom: 6px;
            border-bottom: 2px solid var(--border-light);
            position: relative;
        }

        h2::before {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 60px;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
        }

        h3 {
            color: var(--text-primary);
            font-weight: 600;
            font-size: 17px;
            margin-top: 24px;
            margin-bottom: 10px;
        }

        h4 {
            color: var(--text-primary);
            font-weight: 500;
            font-size: 15px;
            margin-top: 18px;
            margin-bottom: 8px;
        }

         
        p {
            margin-bottom: 12px;
            line-height: 1.6;
            color: var(--text-primary);
        }

         
        table {
            border-collapse: separate;
            border-spacing: 0;
            width: 100%;
            margin: 18px 0;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            overflow: hidden;
            box-shadow: var(--shadow-md);
        }

        th {
            background: linear-gradient(to bottom, var(--accent-primary) 0%, var(--accent-secondary) 100%);
            color: white;
            padding: 14px 16px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid var(--accent-secondary);
        }

        td {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-medium);
            vertical-align: top;
            color: var(--text-primary);
            background-color: var(--bg-secondary);
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:nth-child(even) td {
            background-color: var(--table-stripe);
        }

        tbody tr:hover td {
            background-color: var(--table-hover);
        }

         
        code {
            background-color: var(--code-bg);
            padding: 3px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            color: var(--code-text);
            font-size: 14px;
        }

        pre {
            background: var(--pre-bg);
            border: 1px solid var(--pre-border);
            border-left: 4px solid var(--accent-primary);
            border-radius: 6px;
            padding: 16px;
            margin: 18px 0;
            box-shadow: var(--shadow-sm);
            overflow-x: auto;
            line-height: 1.5;
        }

        pre code {
            background-color: transparent;
            padding: 0;
            color: var(--text-primary);
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
        }

         
        .note {
            background: var(--note-bg);
            border-left: 5px solid var(--note-border);
            border-radius: 4px;
            padding: 14px 16px;
            margin: 18px 0;
            box-shadow: var(--shadow-md);
            position: relative;
        }

        .note::before {
            content: '\2139\FE0F  Note';
            display: block;
            font-weight: 600;
            color: var(--note-text);
            margin-bottom: 6px;
            font-size: 14px;
        }

        .note p {
            color: var(--text-primary);
        }

        .warning {
            background: var(--warning-bg);
            border-left: 5px solid var(--warning-border);
            border-radius: 4px;
            padding: 14px 16px;
            margin: 18px 0;
            box-shadow: var(--shadow-md);
            position: relative;
        }

        .warning::before {
            content: '\26A0\FE0F  Warning';
            display: block;
            font-weight: 600;
            color: var(--warning-text);
            margin-bottom: 6px;
            font-size: 14px;
        }

        .warning p {
            color: var(--text-primary);
        }

         
        ul, ol {
            margin: 12px 0;
            padding-left: 30px;
            line-height: 1.6;
        }

        li {
            margin: 6px 0;
            color: var(--text-primary);
        }

         
        a {
            color: var(--accent-primary);
            text-decoration: none;
        }

        a:hover {
            color: var(--accent-hover);
            text-decoration: underline;
        }

         
        .nav-footer {
            margin-top: 48px;
            padding: 20px 0 12px 0;
            border-top: 2px solid var(--border-light);
            font-size: 11px;
            color: var(--text-tertiary);
            text-align: center;
        }

        .nav-footer p {
            margin: 0;
            font-size: 11px;
        }

         
        .block-icon-container {
            display: table;
            width: 100%;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin: 24px 0;
            padding: 20px;
            box-shadow: var(--shadow-md);
            table-layout: fixed;
        }

        .block-icon-image {
            display: table-cell;
            width: 220px;
            vertical-align: middle;
            padding-right: 20px;
        }

        .block-icon-image img {
            width: 200px;
            height: auto;
            display: block;
        }

        .block-icon-description {
            display: table-cell;
            vertical-align: middle;
            font-size: 16px;
            line-height: 1.7;
            color: var(--text-primary);
        }

         
        p img, .container > img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
            border: 1px solid var(--border-light);
            border-radius: 4px;
            box-shadow: var(--shadow-sm);
        }

         
        @media (max-width: 768px) {
            body {
                padding: 10px 20px;
            }

            .container {
                padding: 20px;
            }

            .page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }

            .microchip-logo {
                height: 40px;
            }

            .page-header h1 {
                font-size: 24px;
            }

            h2 {
                font-size: 20px;
            }

            h3 {
                font-size: 16px;
            }
        }

         
        
        @media (max-width: 1024px) {
             
            .sidebar {
                position: fixed;
                left: -280px;
                top: 0;
                height: 100vh;
                z-index: 999;
                transition: left 0.3s ease;
                box-shadow: 2px 0 8px rgba(0,0,0,0.15);
            }

            .sidebar.mobile-visible {
                left: 0;
            }

             
            .mobile-nav-toggle {
                display: flex;
                align-items: center;
                justify-content: center;
            }

             
            .content-wrapper {
                width: 100%;
            }

            .container {
                margin: 10px 15px;
                padding: 20px;
            }

             
            .sidebar.mobile-visible::after {
                content: '';
                position: fixed;
                top: 0;
                left: 280px;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                z-index: -1;
            }
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                padding: 15px;
            }

            .page-header h1 {
                font-size: 22px;
            }

            .breadcrumbs {
                font-size: 12px;
                padding: 8px 12px;
            }

            .nav-section-title {
                font-size: 13px;
                padding: 8px 15px;
            }

            .nav-link {
                font-size: 12px;
                padding: 6px 15px;
                padding-left: 35px;
            }
        }
        

         
        .under-construction-banner {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            color: white;
            padding: 12px 20px;
            text-align: center;
            font-size: 14px;
            font-weight: 600;
            border-bottom: 3px solid #e65100;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            margin-bottom: 20px;
        }

        .under-construction-banner .icon {
            font-size: 18px;
            margin-right: 8px;
        }

        .under-construction-banner strong {
            color: #fff;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
    </style>
</head>
<body>
    
    
    <div class="doc-wrapper">
        
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2 class="sidebar-title">MPLAB Blockset</h2>
            </div>
            <div class="sidebar-nav">
                
                <div class="nav-section">
                    <a href="../../../" class="nav-section-title" style="display: block; border-left: 3px solid transparent;">
                        <span><span class="icon">🏠</span>Home</span>
                    </a>
                </div>

                
                
                <div class="nav-section" id="section-getting-started">
                    
                    
                    <div class="nav-section-title" onclick="toggleSection('getting-started')">
                        <span><span class="icon">🚀</span>Getting Started</span>
                        <span class="toggle-icon">▶</span>
                    </div>
                    <div class="nav-section-children">
                        
                            
                            
                            <a href="../../../getting_started/overview.html" class="nav-link">Overview</a>
                            
                        
                            
                            
                            <a href="../../../getting_started/installation.html" class="nav-link">Installation</a>
                            
                        
                            
                            
                            <a href="../../../getting_started/quick_start.html" class="nav-link">Quick Start Guide</a>
                            
                        
                            
                            
                            <a href="../../../getting_started/board_templates.html" class="nav-link">Board Templates</a>
                            
                        
                            
                            
                            <a href="../../../getting_started/motor_control_examples.html" class="nav-link">Motor Control Examples</a>
                            
                        
                            
                            
                            <a href="../../../getting_started/scheduler_multitasking.html" class="nav-link">Scheduler &amp; Multitasking</a>
                            
                        
                            
                            
                            <a href="../../../getting_started/external_mode_pil.html" class="nav-link">External Mode &amp; PIL</a>
                            
                        
                            
                            
                            <a href="../../../getting_started/data_visualization.html" class="nav-link">Data Visualization</a>
                            
                        
                            
                            
                            <a href="../../../getting_started/supported_devices.html" class="nav-link">Supported Devices</a>
                            
                        
                    </div>
                    
                </div>
                
                <div class="nav-section" id="section-user-guide">
                    
                    
                    <div class="nav-section-title" onclick="toggleSection('user-guide')">
                        <span><span class="icon">📚</span>User Guide</span>
                        <span class="toggle-icon">▶</span>
                    </div>
                    <div class="nav-section-children">
                        
                            
                            
                            <a href="../../../user_guide/code_generation.html" class="nav-link">Code Generation</a>
                            
                        
                            
                            
                            <a href="../../../user_guide/compiler_setup.html" class="nav-link">Compiler Setup</a>
                            
                        
                            
                            
                            <a href="../../../user_guide/external_mode.html" class="nav-link">External Mode</a>
                            
                        
                            
                            
                            <a href="../../../user_guide/pil_testing.html" class="nav-link">PIL Testing</a>
                            
                        
                    </div>
                    
                </div>
                
                <div class="nav-section" id="section-block-reference">
                    
                    
                    <div class="nav-section-title" onclick="toggleSection('block-reference')">
                        <span><span class="icon">🧩</span>Block Reference</span>
                        <span class="toggle-icon">▶</span>
                    </div>
                    <div class="nav-section-children">
                        
                            
                            
                            <div class="nav-subsection" id="section-pwm-timers">
                                <div class="nav-subsection-title" onclick="toggleSection('pwm-timers')">
                                    <span><span class="icon">⚡</span>PWM &amp; Timers</span>
                                    <span class="toggle-icon">▶</span>
                                </div>
                                <div class="nav-section-children">
                                    
                                        
                                        
                                        <a href="../../../block_reference/pwm_io/pwm.html" class="nav-block-link">PWM</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/pwm_io/pwm_highspeed.html" class="nav-block-link">PWM High-Speed</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/pwm_io/pwm_hs_fep.html" class="nav-block-link">PWM HS FEP</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/pwm_io/pwm_highspeed_override.html" class="nav-block-link">PWM HS Override</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/pwm_io/mcpwm.html" class="nav-block-link">MCPWM (PIC32)</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/pwm_io/pwm_sam7x.html" class="nav-block-link">PWM SAM7x</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/pwm_io/pwm_sam7x_override.html" class="nav-block-link">PWM SAM7x Override</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/pwm_io/tcc_pwm.html" class="nav-block-link">TCC PWM (SAM)</a>
                                        
                                    
                                </div>
                            </div>
                            
                        
                            
                            
                            <div class="nav-subsection" id="section-timers">
                                <div class="nav-subsection-title" onclick="toggleSection('timers')">
                                    <span><span class="icon">⏱️</span>Timers</span>
                                    <span class="toggle-icon">▶</span>
                                </div>
                                <div class="nav-section-children">
                                    
                                        
                                        
                                        <a href="../../../block_reference/timers/timer_config.html" class="nav-block-link">Timer Config</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/timers/input_capture.html" class="nav-block-link">Input Capture</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/timers/output_compare_hw.html" class="nav-block-link">Output Compare (HW)</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/timers/output_compare_sw.html" class="nav-block-link">Output Compare (SW)</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/timers/timer_pil_profiling.html" class="nav-block-link">PIL Profiling Timer</a>
                                        
                                    
                                </div>
                            </div>
                            
                        
                            
                            
                            <div class="nav-subsection" id="section-adc">
                                <div class="nav-subsection-title" onclick="toggleSection('adc')">
                                    <span><span class="icon">📊</span>ADC</span>
                                    <span class="toggle-icon">▶</span>
                                </div>
                                <div class="nav-section-children">
                                    
                                        
                                        
                                        <a href="../../../block_reference/adc/adc.html" class="nav-block-link">ADC (dsPIC)</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/adc/adc_hs_12b.html" class="nav-block-link">ADC HS 12-bit</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/adc/adc_highspeed_sar.html" class="nav-block-link">ADC High-Speed SAR</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/adc/adc_highspeed_sar_dspic.html" class="nav-block-link">ADC HS SAR (dsPIC)</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/adc/adc_same5x.html" class="nav-block-link">ADC (SAM E5x)</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/adc/adc_samrh707x.html" class="nav-block-link">ADC (SAMRH707x)</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/adc/afec_sam7x.html" class="nav-block-link">AFEC (SAM7x)</a>
                                        
                                    
                                </div>
                            </div>
                            
                        
                            
                            
                            <div class="nav-subsection" id="section-communication">
                                <div class="nav-subsection-title" onclick="toggleSection('communication')">
                                    <span><span class="icon">📡</span>Communication</span>
                                    <span class="toggle-icon">▶</span>
                                </div>
                                <div class="nav-section-children">
                                    
                                        
                                        
                                        <div class="nav-subsection" id="section-uart">
                                            <div class="nav-subsection-title" onclick="toggleSection('uart')">
                                                <span><span class="icon"></span>UART</span>
                                                <span class="toggle-icon">▶</span>
                                            </div>
                                            <div class="nav-section-children">
                                                
                                                
                                                <a href="../../../block_reference/communication/uart/uart_config.html" class="nav-block-link">UART Config</a>
                                                
                                                
                                                <a href="../../../block_reference/communication/uart/uart_tx.html" class="nav-block-link">UART Tx</a>
                                                
                                                
                                                <a href="../../../block_reference/communication/uart/uart_rx.html" class="nav-block-link">UART Rx</a>
                                                
                                                
                                                <a href="../../../block_reference/communication/uart/uart_txmatlab.html" class="nav-block-link">UART Tx MATLAB</a>
                                                
                                                
                                                <a href="../../../block_reference/communication/uart/uart_break_and_autobaud.html" class="nav-block-link">UART Break &amp; Autobaud</a>
                                                
                                            </div>
                                        </div>
                                        
                                    
                                        
                                        
                                        <div class="nav-subsection" id="section-can">
                                            <div class="nav-subsection-title" onclick="toggleSection('can')">
                                                <span><span class="icon"></span>CAN</span>
                                                <span class="toggle-icon">▶</span>
                                            </div>
                                            <div class="nav-section-children">
                                                
                                                
                                                <a href="../../../block_reference/communication/can/can_config.html" class="nav-block-link">CAN Config</a>
                                                
                                                
                                                <a href="../../../block_reference/communication/can/can_tx.html" class="nav-block-link">CAN Tx</a>
                                                
                                                
                                                <a href="../../../block_reference/communication/can/can_rx.html" class="nav-block-link">CAN Rx</a>
                                                
                                            </div>
                                        </div>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/communication/i2c.html" class="nav-block-link">I2C Master/Slave</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/communication/spi.html" class="nav-block-link">SPI Master/Slave</a>
                                        
                                    
                                </div>
                            </div>
                            
                        
                            
                            
                            <div class="nav-subsection" id="section-digital-io">
                                <div class="nav-subsection-title" onclick="toggleSection('digital-io')">
                                    <span><span class="icon">🔌</span>Digital I/O</span>
                                    <span class="toggle-icon">▶</span>
                                </div>
                                <div class="nav-section-children">
                                    
                                        
                                        
                                        <a href="../../../block_reference/digital_io/digital_input.html" class="nav-block-link">Digital Input</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/digital_io/digital_output.html" class="nav-block-link">Digital Output</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/digital_io/digital_output_read.html" class="nav-block-link">Digital Output Read</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/digital_io/digital_output_write.html" class="nav-block-link">Digital Output Write</a>
                                        
                                    
                                </div>
                            </div>
                            
                        
                            
                            
                            <div class="nav-subsection" id="section-encoders">
                                <div class="nav-subsection-title" onclick="toggleSection('encoders')">
                                    <span><span class="icon">🔄</span>Encoders</span>
                                    <span class="toggle-icon">▶</span>
                                </div>
                                <div class="nav-section-children">
                                    
                                        
                                        
                                        <a href="../../../block_reference/encoders_counters/qei.html" class="nav-block-link">QEI (Quadrature Encoder)</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/encoders_counters/pdec.html" class="nav-block-link">PDEC (SAM)</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/encoders_counters/qdec_samx.html" class="nav-block-link">QDEC (SAM)</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/encoders_counters/change_notification.html" class="nav-block-link">Change Notification</a>
                                        
                                    
                                </div>
                            </div>
                            
                        
                            
                            
                            <div class="nav-subsection" id="section-analog-io">
                                <div class="nav-subsection-title" onclick="toggleSection('analog-io')">
                                    <span><span class="icon">📉</span>Analog I/O</span>
                                    <span class="toggle-icon">▶</span>
                                </div>
                                <div class="nav-section-children">
                                    
                                        
                                        
                                        <a href="../../../block_reference/analog_io/comparator_opamps_volt_ref/highspeed_analogcomparator.html" class="nav-block-link">High-Speed Comparator</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/analog_io/comparator_opamps_volt_ref/highspeed_analogcomparator_wslope.html" class="nav-block-link">Comparator w/ Slope</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/analog_io/comparator_opamps_volt_ref/op_amp.html" class="nav-block-link">Op-Amp</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/analog_io/comparator_opamps_volt_ref/pga.html" class="nav-block-link">PGA (Programmable Gain Amp)</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/analog_io/dac_samx.html" class="nav-block-link">DAC (SAM)</a>
                                        
                                    
                                </div>
                            </div>
                            
                        
                            
                            
                            <div class="nav-subsection" id="section-system-config">
                                <div class="nav-subsection-title" onclick="toggleSection('system-config')">
                                    <span><span class="icon">⚙️</span>System Config</span>
                                    <span class="toggle-icon">▶</span>
                                </div>
                                <div class="nav-section-children">
                                    
                                        
                                        
                                        <a href="../../../block_reference/system_configuration/master.html" class="nav-block-link">Master</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/system_configuration/interrupt.html" class="nav-block-link">Interrupt</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/system_configuration/compiler_options.html" class="nav-block-link">Compiler Options</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/system_configuration/scheduler_options.html" class="nav-block-link">Scheduler Options</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/system_configuration/idle_task.html" class="nav-block-link">Idle Task</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/system_configuration/mcu_load.html" class="nav-block-link">MCU Load</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/system_configuration/mcu_overload.html" class="nav-block-link">MCU Overload</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/system_configuration/tasks_state.html" class="nav-block-link">Tasks State</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/system_configuration/secondary_core.html" class="nav-block-link">Secondary Core</a>
                                        
                                    
                                </div>
                            </div>
                            
                        
                            
                            
                            <div class="nav-subsection" id="section-utility">
                                <div class="nav-subsection-title" onclick="toggleSection('utility')">
                                    <span><span class="icon">🔧</span>Utility Blocks</span>
                                    <span class="toggle-icon">▶</span>
                                </div>
                                <div class="nav-section-children">
                                    
                                        
                                        
                                        <a href="../../../block_reference/user_functions/c_function_call.html" class="nav-block-link">C Function Call</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/utility/doc.html" class="nav-block-link">Documentation Block</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/utility/msi.html" class="nav-block-link">MSI (Model Sample Info)</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/utility/port_info.html" class="nav-block-link">Port Info</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/utility/timer_info.html" class="nav-block-link">Timer Info</a>
                                        
                                    
                                        
                                        
                                        <a href="../../../block_reference/utility/simulink_reset_config.html" class="nav-block-link">Simulink Reset Config</a>
                                        
                                    
                                </div>
                            </div>
                            
                        
                    </div>
                    
                </div>
                
                <div class="nav-section" id="section-examples">
                    
                    
                    <div class="nav-section-title" onclick="toggleSection('examples')">
                        <span><span class="icon">📖</span>Examples</span>
                        <span class="toggle-icon">▶</span>
                    </div>
                    <div class="nav-section-children">
                        
                            
                            
                            <a href="../../../examples/field_weakening.html" class="nav-link">Field Weakening</a>
                            
                        
                    </div>
                    
                </div>
                
                <div class="nav-section" id="section-github">
                    
                    
                    <a href="https://github.com/microchip-technology/mplab-blockset" class="nav-section-title" style="display: block; border-left: 3px solid transparent;">
                        <span><span class="icon">💻</span>GitHub</span>
                    </a>
                    
                </div>
                
            </div>
        </nav>

        
        <div class="content-wrapper">
            <div class="container">
                <div class="breadcrumbs">
                    <a href="../../../">Home</a>
                    
                        <span>&gt;</span>
                        <a href="../../../block_reference.html">Block Reference</a>
                    
                    <span>&gt;</span>
                    <span>MCHP High-Speed Analog Comparator with Slope Compensation Documentation</span>
                </div>

                
                <div class="under-construction-banner">
                    <span class="icon">⚠️</span>
                    <strong>Documentation Under Construction</strong> —
                    This documentation is currently being developed. All information has not been validated by Microchip yet.
                </div>
                

                <div class="page-header">
                    <h1>MCHP High-Speed Analog Comparator with Slope Compensation Documentation</h1>
                    <div class="page-header-right">
                        <img src="../../../images/microchip-logo.png" alt="Microchip Logo" class="microchip-logo">
                        <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark mode">
                            <span class="theme-icon" id="theme-icon">☀️</span>
                            <span id="theme-text">Light</span>
                        </button>
                    </div>
                </div>

                
  <div class="block-icon-container">
    <picture class="block-icon-image">
        <source srcset="../../../assets/images/blocks/analog/HighSpeed_AnalogComparator_wSlope.svg" type="image/svg+xml">
        <img src="../../../assets/images/blocks/analog/HighSpeed_AnalogComparator_wSlope.png" alt="High-Speed Analog Comparator with Slope Block Icon">
    </picture>
    <div class="block-icon-description">
        Advanced peak current mode control with programmable slope compensation
    </div>
</div>

<h2 id="overview">Overview</h2>
<p>The <strong>MCHP High-Speed Analog Comparator with Slope Compensation</strong> block extends the standard comparator with integrated slope compensation capabilities for peak current mode control applications. This advanced feature prevents sub-harmonic oscillation in current-mode DC-DC converters and motor drives operating at duty cycles above 50%.</p>
<pre><code>                All standard comparator features plus slope compensation
                Programmable compensation ramp generation
                Automatic ramp synchronization with PWM
                Variable slope adjustment for optimal stability
                Sub-microsecond response for high-frequency switching
                Integrated peak current mode control logic
</code></pre>
<h3 id="peak-current-mode-control">Peak Current Mode Control</h3>
<p>Peak current mode control regulates output by controlling the peak inductor current in each switching cycle. Slope compensation stabilizes the control loop when duty cycle exceeds 50%, preventing period-doubling oscillations.
<strong>Why Slope Compensation?</strong>
In peak current mode control with D &gt; 50%, the inductor current slope creates a positive feedback loop leading to sub-harmonic oscillation. Adding a compensation ramp to the current sense signal stabilizes the loop.</p>
<h3 id="typical-applications">Typical Applications</h3>
<ul>
<li><strong>Buck Converters:</strong> DC-DC step-down with peak current control</li>
<li><strong>Boost Converters:</strong> DC-DC step-up with current limiting</li>
<li><strong>Flyback Converters:</strong> Isolated power supplies</li>
<li><strong>Motor Drives:</strong> Peak current regulation for torque control</li>
<li><strong>LED Drivers:</strong> Constant current regulation</li>
</ul>
<h2 id="device-family-support">Device Family Support</h2>
<h4 id="dspic33ep">dsPIC33EP</h4>
<p>With Slope DAC</p>
<h4 id="dspic33ev">dsPIC33EV</h4>
<p>With Slope DAC</p>
<h4 id="dspic33ck">dsPIC33CK</h4>
<p>With Slope DAC</p>
<h4 id="dspic33ch">dsPIC33CH</h4>
<p>With Slope DAC</p>
<h2 id="block-parameters">Block Parameters</h2>
<h3 id="standard-comparator-configuration">Standard Comparator Configuration</h3>
<p>All parameters from the standard [High-Speed Analog Comparator] block are available, plus the following slope compensation parameters:</p>
<h3 id="slope-compensation-configuration">Slope Compensation Configuration</h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Description</th>
          <th>Range/Options</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Slope Enable</td>
          <td>Enable slope compensation ramp generation</td>
          <td>Enabled, Disabled</td>
      </tr>
      <tr>
          <td>Slope DAC Start Value</td>
          <td>Starting value of compensation ramp</td>
          <td>0 to 4095 (12-bit)</td>
      </tr>
      <tr>
          <td>Slope Rate</td>
          <td>Ramp slope in DAC units per PWM period</td>
          <td>0 to 255</td>
      </tr>
      <tr>
          <td>Slope Trigger Source</td>
          <td>PWM generator for ramp synchronization</td>
          <td>PWM1-PWM12 (device-dependent)</td>
      </tr>
      <tr>
          <td>Slope Polarity</td>
          <td>Ramp direction</td>
          <td>Positive (rising), Negative (falling)</td>
      </tr>
  </tbody>
</table>
<h3 id="slope-calculation">Slope Calculation</h3>
<p>Slope Compensation Design: 1. Required slope = 0.5 × Inductor current downslope 2. Downslope = (Vout / L) × Tsw 3. Sense voltage slope = Downslope × Rsense 4. DAC slope = (Sense_Slope / Vref) × 4095 × Fsw Example for 100kHz Buck, L=10µH, Vout=12V, Rsense=0.1Ω: - Downslope = (12 / 10µH) × 10µs = 12 A/µs - Sense slope = 12 × 0.1 = 1.2 V/µs - Required comp = 0.5 × 1.2 = 0.6 V/µs - DAC slope = (0.6 / 3.3) × 4095 × 100kHz = 74 units/period</p>
<h2 id="practical-examples">Practical Examples</h2>
<h3 id="example-1-buck-converter-peak-current-mode">Example 1: Buck Converter Peak Current Mode</h3>
<h4 id="objective">Objective:</h4>
<p>Implement 100kHz buck converter (24V→12V, 5A max) with peak current mode control and slope compensation.</p>
<h4 id="hardware">Hardware:</h4>
<ul>
<li>Input voltage: 24V</li>
<li>Output voltage: 12V (D = 50%)</li>
<li>Switching frequency: 100kHz</li>
<li>Inductor: 22µH</li>
<li>Current sense: 0.05Ω (Rsense)</li>
<li>Max current: 5A (250mV sense voltage)</li>
</ul>
<h4 id="configuration">Configuration:</h4>
<ul>
<li><strong>Comparator 1 Enable:</strong> on</li>
<li><strong>Comparator 1 Pin:</strong> AN0 (current sense input)</li>
<li><strong>Reference:</strong> Internal DAC (current setpoint)</li>
<li><strong>CMREF:</strong> Dynamic (from voltage loop controller)</li>
<li><strong>Slope Enable:</strong> Enabled</li>
<li><strong>Slope Start Value:</strong> 0</li>
<li><strong>Slope Rate:</strong> 62 (calculated below)</li>
<li><strong>Slope Trigger:</strong> PWM1 (main converter PWM)</li>
<li><strong>Slope Polarity:</strong> Positive (rising)</li>
</ul>
<h4 id="slope-calculation-1">Slope Calculation:</h4>
<p>// Buck downslope: m_down = (Vin - Vout) / L = (24 - 12) / 22µH = 0.545 A/µs // Sense voltage downslope: V_down = m_down × Rsense = 0.545 × 0.05 = 27.3 mV/µs // Required compensation (50% of downslope): V_comp = 0.5 × V_down = 13.65 mV/µs // At 100kHz (10µs period): V_comp_period = 13.65 × 10 = 136.5 mV per period // DAC units per period (Vref = 3.3V): Slope_Rate = (136.5mV / 3.3V) × 4095 = 169 units/period // Practical value (accounting for circuit delays): Slope_Rate = 62 (empirically tuned)</p>
<h4 id="results">Results:</h4>
<ul>
<li>Stable operation at all duty cycles (0-95%)</li>
<li>No sub-harmonic oscillation</li>
<li>Fast transient response (&lt; 3 switching cycles)</li>
<li>Accurate current regulation (±2% error)</li>
</ul>
<h3 id="example-2-flyback-converter-with-discontinuous-mode">Example 2: Flyback Converter with Discontinuous Mode</h3>
<h4 id="objective-1">Objective:</h4>
<p>Design 50kHz flyback converter (12V→48V isolated) with peak current control in discontinuous conduction mode (DCM).</p>
<h4 id="specifications">Specifications:</h4>
<ul>
<li>Input: 9-15V (12V nominal)</li>
<li>Output: 48V @ 1A (48W)</li>
<li>Flyback transformer: Lp=100µH, n=1:4</li>
<li>DCM operation (inductor current reaches zero)</li>
<li>Current sense: 0.1Ω primary side</li>
</ul>
<h4 id="configuration-1">Configuration:</h4>
<ul>
<li><strong>Comparator 2 Enable:</strong> on</li>
<li><strong>Comparator 2 Pin:</strong> AN1 (primary current sense)</li>
<li><strong>Reference:</strong> Internal DAC</li>
<li><strong>CMREF:</strong> From outer voltage loop (typically 1.5-2.0V)</li>
<li><strong>Slope Enable:</strong> Enabled (critical for DCM stability)</li>
<li><strong>Slope Start Value:</strong> 100 (offset for DCM)</li>
<li><strong>Slope Rate:</strong> 85</li>
<li><strong>Slope Trigger:</strong> PWM2</li>
<li><strong>HYSSEL:</strong> 15mV (noise immunity)</li>
</ul>
<h4 id="dcm-slope-compensation">DCM Slope Compensation:</h4>
<p>// DCM requires different compensation approach: // Peak current varies with input voltage // Slope compensation stabilizes against input variations // Primary current ramp-up slope: m_up = Vin / Lp = 12V / 100µH = 0.12 A/µs = 12 mV/µs (at Rsense=0.1Ω) // DCM compensation (0.5-0.75 × upslope): V_comp = 0.6 × 12 = 7.2 mV/µs // At 50kHz (20µs period): V_comp_period = 7.2 × 20 = 144 mV // DAC slope: Slope_Rate = (144mV / 3.3V) × 4095 = 179 → Use 85 (tuned) // Start value offsets ramp for DCM detection Slope_Start = 100 // Prevents false triggers at DCM start</p>
<h3 id="example-3-interleaved-buck-with-multiple-phases">Example 3: Interleaved Buck with Multiple Phases</h3>
<h4 id="objective-2">Objective:</h4>
<p>2-phase interleaved buck converter with independent slope compensation for each phase.</p>
<h4 id="system">System:</h4>
<ul>
<li>Input: 48V</li>
<li>Output: 12V @ 20A (10A per phase)</li>
<li>Frequency: 200kHz per phase (400kHz effective)</li>
<li>Phase shift: 180°</li>
<li>Inductors: 4.7µH per phase</li>
</ul>
<h4 id="phase-1-configuration">Phase 1 Configuration:</h4>
<ul>
<li><strong>Comparator 1:</strong> Phase 1 current sense (AN0)</li>
<li><strong>Slope Trigger:</strong> PWM1</li>
<li><strong>Slope Rate:</strong> 145</li>
</ul>
<h4 id="phase-2-configuration">Phase 2 Configuration:</h4>
<ul>
<li><strong>Comparator 2:</strong> Phase 2 current sense (AN1)</li>
<li><strong>Slope Trigger:</strong> PWM2 (180° phase shifted)</li>
<li><strong>Slope Rate:</strong> 145 (matched to Phase 1)</li>
</ul>
<h4 id="interleaving-benefits">Interleaving Benefits:</h4>
<p>// Interleaved advantages: // 1. Reduced input/output ripple (400kHz effective) // 2. Lower per-phase current stress (10A vs 20A) // 3. Better thermal distribution // 4. Smaller passive components // Slope compensation per phase: m_down = (48 - 12) / 4.7µH = 7.66 A/µs V_comp = 0.5 × 7.66 × 0.025Ω = 95.7 mV/µs Slope_Rate = (95.7mV × 5µs / 3.3V) × 4095 = 145 // Phase synchronization ensures: // - Independent current control per phase // - Automatic current sharing // - Fault protection per phase</p>
<h3 id="example-4-led-driver-with-current-regulation">Example 4: LED Driver with Current Regulation</h3>
<h4 id="objective-3">Objective:</h4>
<p>High-brightness LED driver with peak current mode control and dimming support.</p>
<h4 id="specifications-1">Specifications:</h4>
<ul>
<li>LED string: 10 LEDs × 3.3V = 33V forward voltage</li>
<li>LED current: 1A constant</li>
<li>Input: 12-42V automotive</li>
<li>Boost topology with current feedback</li>
<li>PWM dimming: 1kHz</li>
</ul>
<h4 id="configuration-2">Configuration:</h4>
<ul>
<li><strong>Comparator 3 Enable:</strong> on</li>
<li><strong>Comparator 3 Pin:</strong> AN2 (LED current sense)</li>
<li><strong>Reference:</strong> 1.0V (for 1A @ 1Ω sense)</li>
<li><strong>Slope Enable:</strong> Enabled</li>
<li><strong>Slope Rate:</strong> 55 (for 150kHz switching)</li>
<li><strong>Dimming:</strong> AND gate with 1kHz PWM signal</li>
</ul>
<h4 id="current-regulation">Current Regulation:</h4>
<p>// Peak current mode for LED driver: // 1. Comparator trips at peak inductor current // 2. Slope compensation prevents oscillation // 3. Average current = Peak - (ΔI/2) // For 1A average LED current: Peak_Current = 1A + (ΔI/2) ΔI = (Vout - Vin) / (L × Fsw) × D // At worst case (Vin = 12V, Vout = 36V): ΔI = (36 - 12) / (22µH × 150kHz) × 0.67 = 0.48A Peak_Current = 1A + 0.24A = 1.24A // Comparator reference for 1.24A peak: CMREF = 1.24V @ 1Ω sense resistor // Dimming implementation: // Comparator output AND 1kHz PWM → Drive MOSFET // Result: Regulated 1A during ON time, 0A during OFF</p>
<h2 id="slope-compensation-theory">Slope Compensation Theory</h2>
<h3 id="sub-harmonic-oscillation-prevention">Sub-Harmonic Oscillation Prevention</h3>
<p>Understanding why slope compensation is necessary:
Without Slope Compensation (D &gt; 50%): - Cycle N: Current peak = Ipeak - Perturbation causes small increase → Ipeak + ΔI - Duty cycle increases to maintain voltage - Cycle N+1: Peak becomes Ipeak + 2×ΔI - Oscillation grows exponentially → System unstable With Slope Compensation: - Compensation ramp added to current sense - Effective downslope increased - Perturbations decay instead of grow - System stable at all duty cycles</p>
<h3 id="optimal-slope-selection">Optimal Slope Selection</h3>
<table>
  <thead>
      <tr>
          <th>Compensation Level</th>
          <th>Stability</th>
          <th>Dynamic Response</th>
          <th>Recommendation</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>&lt;</td>
          <td>0.5 × Downslope</td>
          <td>Marginal</td>
          <td>Fast</td>
      </tr>
      <tr>
          <td>0.5 × Downslope</td>
          <td>Good</td>
          <td>Good</td>
          <td>Minimum for stability</td>
      </tr>
      <tr>
          <td>1.0 × Downslope</td>
          <td>Excellent</td>
          <td>Slower</td>
          <td>Optimal compromise</td>
      </tr>
      <tr>
          <td>&gt; 1.5 × Downslope</td>
          <td>Excellent</td>
          <td>Very slow</td>
          <td>Over-compensated</td>
      </tr>
  </tbody>
</table>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="common-issues-and-solutions">Common Issues and Solutions</h3>
<table>
  <thead>
      <tr>
          <th>Issue</th>
          <th>Possible Cause</th>
          <th>Solution</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Sub-harmonic oscillation at D&gt;50%</td>
          <td>Insufficient slope compensation</td>
          <td>Increase Slope Rate to 0.75-1.0× downslope</td>
      </tr>
      <tr>
          <td>Slow transient response</td>
          <td>Excessive slope compensation</td>
          <td>Reduce Slope Rate, ensure not &gt; 1.5× downslope</td>
      </tr>
      <tr>
          <td>Ramp not synchronized with PWM</td>
          <td>Wrong slope trigger source</td>
          <td>Verify Slope Trigger matches PWM generator</td>
      </tr>
      <tr>
          <td>Current limit varies with duty cycle</td>
          <td>Slope polarity incorrect</td>
          <td>Check Slope Polarity matches current sense</td>
      </tr>
      <tr>
          <td>Unstable at light load</td>
          <td>Slope start value too high</td>
          <td>Reduce Slope Start Value or add DCM detection</td>
      </tr>
  </tbody>
</table>
<h3 id="measurement-and-tuning">Measurement and Tuning</h3>
<p><strong>Oscilloscope Setup for Tuning:</strong></p>
<ul>
<li><strong>CH1:</strong> Current sense signal (before comparator)</li>
<li><strong>CH2:</strong> Comparator output (trip signal)</li>
<li><strong>CH3:</strong> PWM output (gate drive)</li>
<li><strong>CH4:</strong> Output voltage or current</li>
<li><strong>Trigger:</strong> PWM rising edge</li>
<li><strong>Look for:</strong> Consistent peak current, no period doubling</li>
</ul>
<h2 id="related-blocks">Related Blocks</h2>
<ul>
<li>[MCHP High-Speed Analog Comparator] - Basic comparator without slope compensation</li>
<li>[MCHP PWM High-Speed] - PWM generator for synchronization</li>
<li>[MCHP Operational Amplifier] - Current sense amplification</li>
<li>[MCHP Programmable Gain Amplifier] - Variable gain current sensing</li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>
<p><strong>Application Notes:</strong></p>
</li>
<li>
<p>[AN2743] - Peak Current Mode Control with Slope Compensation</p>
</li>
<li>
<p>[AN1106] - Current Mode Control for DC-DC Converters</p>
</li>
<li>
<p>[AN1467] - Interleaved Buck Converter Design</p>
</li>
<li>
<p><strong>Theory:</strong></p>
</li>
<li>
<p>&ldquo;Slope Compensation for Current Mode Control&rdquo; - Unitrode (TI)</p>
</li>
<li>
<p>&ldquo;Stability Analysis of Peak Current Mode Control&rdquo; - IEEE Papers</p>
</li>
<li>
<p><strong>Design Tools:</strong> MCHP Power Supply Designer (slope compensation calculator)</p>
</li>
</ul>
<h2 id="see-also">See Also</h2>
<h3 id="application-notes">Application Notes</h3>
<ul>
<li><a href="https://www.microchip.com/AN2743">AN2743 - Sensored Field-Oriented Control of Three-Phase Permanent Magnet Motors</a></li>
<li><a href="https://www.microchip.com/AN1106">AN1106 - Stepper Motor Control Using dsPIC30F</a></li>
<li><a href="https://www.microchip.com/AN1467">AN1467 - Sensorless Field-Oriented Control of BLDC Motors</a></li>
</ul>



                <div class="nav-footer">
                    <p>Last updated: January 2025 | MPLAB Blockset Documentation</p>
                    <p>&copy; 2025 Microchip Technology Inc. All rights reserved.</p>
                </div>
            </div>
        </div>

        
        <button class="mobile-nav-toggle" onclick="toggleMobileSidebar()" aria-label="Toggle navigation">
            ☰
        </button>
    </div>
    

    <script>
        
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeButton(newTheme);
        }

        function updateThemeButton(theme) {
            const themeIcon = document.getElementById('theme-icon');
            const themeText = document.getElementById('theme-text');

            if (theme === 'dark') {
                themeIcon.textContent = '🌙';
                themeText.textContent = 'Dark';
            } else {
                themeIcon.textContent = '☀️';
                themeText.textContent = 'Light';
            }
        }

        
        (function initTheme() {
            const storedTheme = localStorage.getItem('theme');
            const systemPrefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            const theme = storedTheme || (systemPrefersDark ? 'dark' : 'light');

            document.documentElement.setAttribute('data-theme', theme);
            updateThemeButton(theme);
        })();

        
        if (window.matchMedia) {
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                if (!localStorage.getItem('theme')) {
                    const newTheme = e.matches ? 'dark' : 'light';
                    document.documentElement.setAttribute('data-theme', newTheme);
                    updateThemeButton(newTheme);
                }
            });
        }

        
        

        
        window.toggleSection = function(identifier) {
            const section = document.getElementById('section-' + identifier);
            if (section) {
                section.classList.toggle('expanded');

                
                
                if (section.classList.contains('nav-section')) {
                    
                    const expandedSections = getExpandedSections();
                    if (section.classList.contains('expanded')) {
                        expandedSections.add(identifier);
                    } else {
                        expandedSections.delete(identifier);
                    }
                    localStorage.setItem('expandedSections', JSON.stringify([...expandedSections]));
                }
                
                
            }
        };

        
        function getExpandedSections() {
            const stored = localStorage.getItem('expandedSections');
            return new Set(stored ? JSON.parse(stored) : []);
        }

        
        function restoreExpandedSections() {
            const expandedSections = getExpandedSections();
            expandedSections.forEach(identifier => {
                const section = document.getElementById('section-' + identifier);
                if (section) {
                    section.classList.add('expanded');
                }
            });
        }

        
        function highlightActivePage() {
            const currentPath = window.location.pathname;
            const navLinks = document.querySelectorAll('.nav-link, .nav-block-link, .nav-section-title[href], .nav-subsection-title[href]');

            navLinks.forEach(link => {
                const linkPath = new URL(link.href, window.location.origin).pathname;
                if (linkPath === currentPath) {
                    link.classList.add('active');

                    
                    const parentSubsection = link.closest('.nav-subsection');
                    if (parentSubsection && !parentSubsection.classList.contains('expanded')) {
                        parentSubsection.classList.add('expanded');
                        
                    }

                    
                    const parentSection = link.closest('.nav-section');
                    if (parentSection && !parentSection.classList.contains('expanded')) {
                        parentSection.classList.add('expanded');
                        
                        const identifier = parentSection.id.replace('section-', '');
                        const expandedSections = getExpandedSections();
                        expandedSections.add(identifier);
                        localStorage.setItem('expandedSections', JSON.stringify([...expandedSections]));
                    }
                }
            });
        }

        
        window.toggleMobileSidebar = function() {
            const sidebar = document.querySelector('.sidebar');
            if (sidebar) {
                sidebar.classList.toggle('mobile-visible');
            }
        };

        
        (function initSidebar() {
            restoreExpandedSections();
            highlightActivePage();

            
            const activeLink = document.querySelector('.nav-link.active');
            if (activeLink) {
                const parentSection = activeLink.closest('.nav-section');
                if (parentSection && parentSection.id) {
                    const identifier = parentSection.id.replace('section-', '');
                    const expandedSections = getExpandedSections();
                    if (!expandedSections.has(identifier)) {
                        expandedSections.add(identifier);
                        localStorage.setItem('expandedSections', JSON.stringify([...expandedSections]));
                    }
                }
            }
        })();
        
    </script>
</body>
</html>
